---
title: "Grupo 1 - Seminario Investigación"
output: 
  flexdashboard::flex_dashboard:
    storyboard: true
    orientation: columns
    vertical_layout: fill
    theme: default
    
runtime: shiny
---

```{r setup, include=FALSE}
library(flexdashboard)
library(shiny)
library(import)
library(dplyr)
library(highcharter)
```

```{r data}
import::from("./productivity.R", region_productivity_chart, country_productivity)
import::from("./income_level.R", income_level, income_level_chart_generator)
import::from("./poverty_thresholds.R", poverty_threshold, poverty_threshold_chart_generator)
```

### Productividad per capita ha incrementado constantemente década tras década en todas las regiones, excepto África y Medio Oriente

```{r}
region_productivity_chart
```

***
#### **Productividad por hora laborada**
- Es una medida de el Producto Interno Bruto por hora laborada.
- Los datos están calculados al precio internacional del dólar del 2011, ajustado a inflación y a niveles de precio entre países
- La fecha de inicio es 1970 debido a que es la calidad de los datos previos a ese año es baja
- Fuente: Feenstra, Robert C., Robert Inklaar and Marcel P. Timmer (2015), "The Next Generation of the Penn World Table" American Economic Review, 105(10), 3150-3182, available for download at [link](www.ggdc.net/pwt). PWT v9.1


### El mayor incremento en productividad se ha visto en el hemisferio norte y algunos países en el pacífico. También cabe destacar el incremento en Arabia Saudita

```{r}
renderHighchart(
  hcmap(
    "custom/world-robinson-lowres", 
    data = filter(country_productivity,Year==input$year_input) ,
    name = "Productivity per capita", 
    value = "Productivity",
    borderWidth = 0,
    nullColor = "#d3d3d3",
    joinBy = c("iso-a3","RegionCode")
  ) %>%
    hc_colorAxis(
      stops = color_stops(colors = viridisLite::viridis(5, begin = 0.1)),
      type = "linear",
      max=100
    ) %>%
    hc_mapNavigation(enabled = TRUE)
)
```

***
#### **Productividad por hora laborada**

```{r}
sliderInput("year_input", "Año:",
            min = 1970, max = 2019, step = 10,sep = "", 
            value = 1970)
```

- Es una medida de el Producto Interno Bruto por hora laborada.
- Los datos están calculados al precio internacional del dólar del 2011, ajustado a inflación y a niveles de precio entre países
- La fecha de inicio es 1970 debido a que es la calidad de los datos previos a ese año es baja
- Fuente: Feenstra, Robert C., Robert Inklaar and Marcel P. Timmer (2015), "The Next Generation of the Penn World Table" American Economic Review, 105(10), 3150-3182, available for download at [link](www.ggdc.net/pwt). PWT v9.1


### Los datos de productividad muestran una correlación positiva con la estadística de nivel de ingreso del Banco Mundial.

```{r}
renderHighchart( income_level_chart_generator(input$income_level_year,income_level))
```

***
#### **Nivel de ingreso**

```{r}
sliderInput("income_level_year", "Año:",
            min = 1990, max = 2010, step = 10,sep = "", 
            value = 1990)
```

- Es una clasificación realizada por el Banco Mundial, donde se dividen a los paises en 4 categorías basadas en el GNI (Gross National Income) per cápita en USD.
- El rango de fechas está determinado por la disponibilidad de los datos.
- Se seleccionaron las décadas que pudieran calzar con las mostradas en el mapa de productividad
- Fuente: [World Bank WDI](http://databank.worldbank.org/data/download/site-content/OGHIST.xls)



### A nivel mundial, el porcentaje de personas con ingresos mayores a $10 continua amentando de forma constante, mientras la pobreza extrema disminuye



```{r}
renderHighchart(poverty_threshold_chart_generator(input$poverty_threshold_region,poverty_threshold))
```

***
#### **Umbrales de pobreza**
```{r}
selectInput(
  "poverty_threshold_region", "Region", c('East Asia and Pacific', 'Europe and Central Asia',
       'Latin America and the Caribbean', 'Middle East and North Africa',
       'North America', 'South Asia', 'Sub-Saharan Africa', 'World'),
  selected = "World",
  multiple = FALSE,
  selectize = TRUE,
)
```

- Los datos están calculados al precio internacional del dólar del 2011, ajustado a inflación y a niveles de precio entre países
- El rango de fechas está determinado por la disponibilidad de los datos.
- Fuente: [World Bank, PovcalNet](http://iresearch.worldbank.org/PovcalNet/povDuplicateWB.aspx)

